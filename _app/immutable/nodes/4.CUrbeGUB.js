import"../chunks/DsnmJJEf.js";import{o as Te}from"../chunks/ClPj5Hem.js";import{o as Z,h as D,Y as je,q as ve,k as Ae,j as Me,aj as T,am as Ce,l as Ie,H as Fe,m as ce,p as ee,z as W,$ as Ne,a8 as ke,u as se,w as He,v as Re,ac as pe,G as Se,an as Ue,ao as ue,ap as $e,x as he,y as qe,aq as De,ar as ae,X as me,as as Le,at as Oe,a1 as ze,au as Xe,ab as Ge,av as Pe,a5 as We,aw as Ye,ax as Be,b as P,d as g,r as _,s as N,n as Ve,a as z,t as ne,ae as Je,ay as R,az as te,af as Ke,aA as v,f as Qe,e as Ze,aB as ea}from"../chunks/BQYZwpWA.js";import{d as _e,s as B}from"../chunks/-RwXhcxS.js";import{i as Y}from"../chunks/vdHdxetM.js";import{s as aa}from"../chunks/72KRumsl.js";import{H as ta}from"../chunks/CqN43un4.js";import{b as ra}from"../chunks/D2syMiyZ.js";function sa(t,a){return a}function na(t,a,e){for(var r=t.items,n=[],i=a.length,d=0;d<i;d++)Xe(a[d].e,n,!0);var x=i>0&&n.length===0&&e!==null;if(x){var b=e.parentNode;Ge(b),b.append(e),r.clear(),S(t,a[0].prev,a[i-1].next)}Pe(n,()=>{for(var h=0;h<i;h++){var w=a[h];x||(r.delete(w.k),S(t,w.prev,w.next)),me(w.e,!x)}})}function ia(t,a,e,r,n,i=null){var d=t,x={flags:a,items:new Map,first:null};{var b=t;d=D?Z(je(b)):b.appendChild(ve())}D&&Ae();var h=null,w=!1,j=new Map,l=Ce(()=>{var c=e();return Se(c)?c:c==null?[]:pe(c)}),m,o;function f(){la(o,m,x,j,d,n,a,r,e),i!==null&&(m.length===0?h?he(h):h=se(()=>i(d)):h!==null&&qe(h,()=>{h=null}))}Me(()=>{o??=We,m=T(l);var c=m.length;if(w&&c===0)return;w=c===0;let H=!1;if(D){var A=Ie(d)===Fe;A!==(c===0)&&(d=ce(),Z(d),ee(!1),H=!0)}if(D){for(var u=null,E,p=0;p<c;p++){if(W.nodeType===Ne&&W.data===ke){d=W,H=!0,ee(!1);break}var M=m[p],C=r(M,p);E=ie(W,x,u,null,M,C,p,n,a,e),x.items.set(C,E),u=E}c>0&&Z(ce())}if(D)c===0&&i&&(h=se(()=>i(d)));else if(He()){var U=new Set,I=Re;for(p=0;p<c;p+=1){M=m[p],C=r(M,p);var L=x.items.get(C)??j.get(C);L?xe(L,M,p):(E=ie(null,x,null,null,M,C,p,n,a,e,!0),j.set(C,E)),U.add(C)}for(const[q,O]of x.items)U.has(q)||I.skipped_effects.add(O.e);I.add_callback(f)}else f();H&&ee(!0),T(l)}),D&&(d=W)}function la(t,a,e,r,n,i,d,x,b){var h=a.length,w=e.items,j=e.first,l=j,m,o=null,f=[],c=[],H,A,u,E;for(E=0;E<h;E+=1){if(H=a[E],A=x(H,E),u=w.get(A),u===void 0){var p=r.get(A);if(p!==void 0){r.delete(A),w.set(A,p);var M=o?o.next:l;S(e,o,p),S(e,p,M),re(p,M,n),o=p}else{var C=l?l.e.nodes_start:n;o=ie(C,e,o,o===null?e.first:o.next,H,A,E,i,d,b)}w.set(A,o),f=[],c=[],l=o.next;continue}if(xe(u,H,E),(u.e.f&ae)!==0&&he(u.e),u!==l){if(m!==void 0&&m.has(u)){if(f.length<c.length){var U=c[0],I;o=U.prev;var L=f[0],q=f[f.length-1];for(I=0;I<f.length;I+=1)re(f[I],U,n);for(I=0;I<c.length;I+=1)m.delete(c[I]);S(e,L.prev,q.next),S(e,o,L),S(e,q,U),l=U,o=q,E-=1,f=[],c=[]}else m.delete(u),re(u,l,n),S(e,u.prev,u.next),S(e,u,o===null?e.first:o.next),S(e,o,u),o=u;continue}for(f=[],c=[];l!==null&&l.k!==A;)(l.e.f&ae)===0&&(m??=new Set).add(l),c.push(l),l=l.next;if(l===null)continue;u=l}f.push(u),o=u,l=u.next}if(l!==null||m!==void 0){for(var O=m===void 0?[]:pe(m);l!==null;)(l.e.f&ae)===0&&O.push(l),l=l.next;var V=O.length;if(V>0){var J=h===0?n:null;na(e,O,J)}}t.first=e.first&&e.first.e,t.last=o&&o.e;for(var s of r.values())me(s.e);r.clear()}function xe(t,a,e,r){$e(t.v,a),t.i=e}function ie(t,a,e,r,n,i,d,x,b,h,w){var j=(b&Le)!==0,l=(b&Oe)===0,m=j?l?Ue(n,!1,!1):ue(n):n,o=(b&De)===0?d:ue(d),f={i:o,v:m,k:i,a:null,e:null,prev:e,next:r};try{if(t===null){var c=document.createDocumentFragment();c.append(t=ve())}return f.e=se(()=>x(t,m,o,h),D),f.e.prev=e&&e.e,f.e.next=r&&r.e,e===null?w||(a.first=f):(e.next=f,e.e.next=f.e),r!==null&&(r.prev=f,r.e.prev=f.e),f}finally{}}function re(t,a,e){for(var r=t.next?t.next.e.nodes_start:e,n=a?a.e.nodes_start:e,i=t.e.nodes_start;i!==null&&i!==r;){var d=ze(i);n.before(i),i=d}}function S(t,a,e){a===null?t.first=e:(a.next=e,a.e.next=e&&e.e),e!==null&&(e.prev=a,e.e.prev=a&&a.e)}function oa(t,a,e=a){Ye(t,"change",()=>{e(t.files)}),D&&t.files&&e(t.files),Be(()=>{t.files=a()})}var da=P('<div class="fixed inset-0 bg-[#7777] backdrop-filter-[blur(4px)] pt-20 z-999"><div class="p-2 m-auto w-90 rounded-sm shadow-md bg-[#fff]"><div class="flex justify-end"><button class="text-lg !bg-[transparent] !text-[#333] !p-1">&times;</button></div> <p class="text-center text-[1.2rem]"><!></p></div></div>');function fa(t,a){var e=da(),r=g(e),n=g(r),i=g(n);i.__click=function(...b){a.onClose?.apply(this,b)},_(n);var d=N(n,2),x=g(d);aa(x,()=>a.children??Ve),_(d),_(r),_(e),z(t,e)}_e(["click"]);var ca=P('<div class="fixed top-0 left-0 right-0 z-999"><div class="p-2 bg-[#333] shadow-md m-1 rounded-md"><p class="text-[#fff]"> </p></div></div>');function ua(t,a){var e=ca(),r=g(e),n=g(r),i=g(n,!0);_(n),_(r),_(e),ne(()=>B(i,a.text)),z(t,e)}var va=P('<div><form><div><p class="text-center">Upload your exported WhatsApp chats.</p></div> <div class="p-3 flex flex-column justify-center items-center"><label for="chat">Upload &uarr; <input type="file" name="chat" id="chat" class="!hidden"/></label></div></form></div>'),pa=(t,a,e)=>{T(a)==="ascending"?(v(a,"descending"),e.sort((r,n)=>n.count-r.count)):(v(a,"ascending"),e.sort((r,n)=>r.count-n.count))},ha=P('<p class="flex p-1 w-[80dvw] rounded-sm even:bg-[#ccc7]"><span class="svelte-2j7mc4"> </span> <span class="svelte-2j7mc4"> </span></p>'),ma=P('<div class="max-h-[65dvh] overflow-auto"><div class="sticky top-0 left-0 right-0 bg-[#fff] shadow-sm"><h3 class="text-center text-xl font-bold">Emojis found in chat:</h3> <p class="flex justify-end"><button class="!bg-[transparent] !text-[var(--button-primary)] text-md">Change order</button></p></div> <p class="flex p-1 w-[80dvw] rounded-sm even:bg-[#ccc7]"><span class="svelte-2j7mc4">Emoji</span> <span class="svelte-2j7mc4">Usage</span></p> <div class="flex justify-center flex-col items-center"></div></div> <div class="mt-4 p-2 flex flex-col justify-around items-center h-[8rem]"><button>Share stats</button> <button>Upload another chat</button></div>',1),_a=P('<section><!> <div class="p-2 grid place-items-center h-[100%]"><!> <!></div> <!> <!></section>');function Aa(t,a){Je(a,!0);const e=Intl.NumberFormat("en-US",{style:"decimal",useGrouping:!0});let r=[],n=R(te([])),i=te([]),d=R(te([])),x=R(void 0),b=R(void 0),h=R(""),w=R("descending"),j=R(!0),l=R(!1),m=R(""),o=R("Loading Unicode Emoji list. Please wait");Te(()=>{const s=new XMLHttpRequest;s.open("GET",`${ra}/array.json`),s.onload=function(){s.status===200?v(n,JSON.parse(s.responseText).emojis,!0):(v(j,!0),v(o,"An error occured. Failed to load Unicode Emoji List"))},s.onloadend=function(){v(j,!1)},s.send()});function f(){setTimeout(()=>{v(l,!1)},3e3)}function c(s){v(b,s.target.files[0],!0);const y=new FileReader;v(o,"Parsing chat..."),v(j,!0),y.onload=async function(F){v(h,await F.target.result,!0),v(j,!1);const k=T(h).replace(/\d/g,"").split("").filter($=>$!==" ");T(n).forEach($=>{const X=k.filter(G=>G===$);r.push(...X)}),H()},y.readAsText(T(b))}function H(){i.length=0,v(d,[...new Set(r)],!0),T(d).forEach(async s=>{i.push({emoji:s,count:r.filter(y=>s===y).length})}),i.sort((s,y)=>y.count-s.count),i.length===0&&(v(l,!0),v(m,"I could not find emojis in here, ensure you uploaded a TXT file of an exported WhatsApp chat. If you are sure you did, you lot don't use emojis when chatting eh?"),f(),A())}function A(){r.length=0,i.length=0,v(h,""),v(w,"descending"),v(x,void 0),v(b,void 0)}function u(){let s="";i.slice(0,5).forEach(F=>s+=`
${F.emoji} -> ${F.count}`);try{navigator.share({text:`Top emojis in WhatsApp chat with ${T(b).name}: ${s}. Try it out now.
`,url:"https://temi-tade.github.io/TextMoji"})}catch{v(j,!0),v(o,"An error occured while trying to share")}}var E=_a(),p=g(E);ta(p,{label:"TextMoji"});var M=N(p,2),C=g(M);{var U=s=>{var y=va(),F=g(y),k=N(g(F),2),$=g(k),X=N(g($));X.__change=c,_($),_(k),_(F),_(y),oa(X,()=>T(x),G=>v(x,G)),z(s,y)};Y(C,s=>{T(h)===""&&s(U)})}var I=N(C,2);{var L=s=>{var y=ma(),F=Qe(y),k=g(F),$=N(g(k),2),X=g($);X.__click=[pa,w,i],_($),_(k);var G=N(k,4);ia(G,21,()=>i,sa,(be,de)=>{var K=ha(),Q=g(K),Ee=g(Q,!0);_(Q);var fe=N(Q,2),we=g(fe,!0);_(fe),_(K),ne(ye=>{B(Ee,T(de).emoji),B(we,ye)},[()=>e.format(T(de).count)]),z(be,K)}),_(G),_(F);var le=N(F,2),oe=g(le);oe.__click=u;var ge=N(oe,2);ge.__click=A,_(le),z(s,y)};Y(I,s=>{i.length!==0&&s(L)})}_(M);var q=N(M,2);{var O=s=>{fa(s,{onClose:()=>v(j,!1),children:(y,F)=>{Ze();var k=ea();ne(()=>B(k,T(o))),z(y,k)}})};Y(q,s=>{T(j)&&s(O)})}var V=N(q,2);{var J=s=>{ua(s,{get text(){return T(m)}})};Y(V,s=>{T(l)&&s(J)})}_(E),z(t,E),Ke()}_e(["change","click"]);export{Aa as component};
