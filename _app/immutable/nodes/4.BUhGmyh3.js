import"../chunks/DsnmJJEf.js";import{o as Te}from"../chunks/ClPj5Hem.js";import{o as Z,h as D,Y as je,q as ve,k as Ae,j as Me,aj as T,am as Ce,l as Ie,H as Ne,m as ce,p as ee,z as W,$ as Se,a8 as $e,u as se,w as ke,v as Fe,ac as pe,G as He,an as Re,ao as ue,ap as Ue,x as he,y as qe,aq as De,ar as ae,X as me,as as Le,at as Oe,a1 as ze,au as Xe,ab as Ge,av as Pe,a5 as We,aw as Ye,ax as Be,b as P,d as g,r as _,s as S,n as Ve,a as z,t as ne,ae as Je,ay as F,az as te,af as Ke,aA as v,f as Qe,e as Ze,aB as ea}from"../chunks/BQYZwpWA.js";import{d as _e,s as B}from"../chunks/-RwXhcxS.js";import{i as Y}from"../chunks/vdHdxetM.js";import{s as aa}from"../chunks/72KRumsl.js";import{H as ta}from"../chunks/CqN43un4.js";import{b as ra}from"../chunks/a2oSouYx.js";function sa(t,a){return a}function na(t,a,e){for(var r=t.items,s=[],n=a.length,f=0;f<n;f++)Xe(a[f].e,s,!0);var x=n>0&&s.length===0&&e!==null;if(x){var b=e.parentNode;Ge(b),b.append(e),r.clear(),H(t,a[0].prev,a[n-1].next)}Pe(s,()=>{for(var h=0;h<n;h++){var y=a[h];x||(r.delete(y.k),H(t,y.prev,y.next)),me(y.e,!x)}})}function ia(t,a,e,r,s,n=null){var f=t,x={flags:a,items:new Map,first:null};{var b=t;f=D?Z(je(b)):b.appendChild(ve())}D&&Ae();var h=null,y=!1,j=new Map,l=Ce(()=>{var c=e();return He(c)?c:c==null?[]:pe(c)}),m,o;function d(){la(o,m,x,j,f,s,a,r,e),n!==null&&(m.length===0?h?he(h):h=se(()=>n(f)):h!==null&&qe(h,()=>{h=null}))}Me(()=>{o??=We,m=T(l);var c=m.length;if(y&&c===0)return;y=c===0;let k=!1;if(D){var M=Ie(f)===Ne;M!==(c===0)&&(f=ce(),Z(f),ee(!1),k=!0)}if(D){for(var u=null,E,p=0;p<c;p++){if(W.nodeType===Se&&W.data===$e){f=W,k=!0,ee(!1);break}var C=m[p],I=r(C,p);E=ie(W,x,u,null,C,I,p,s,a,e),x.items.set(I,E),u=E}c>0&&Z(ce())}if(D)c===0&&n&&(h=se(()=>n(f)));else if(ke()){var R=new Set,N=Fe;for(p=0;p<c;p+=1){C=m[p],I=r(C,p);var L=x.items.get(I)??j.get(I);L?xe(L,C,p):(E=ie(null,x,null,null,C,I,p,s,a,e,!0),j.set(I,E)),R.add(I)}for(const[q,O]of x.items)R.has(q)||N.skipped_effects.add(O.e);N.add_callback(d)}else d();k&&ee(!0),T(l)}),D&&(f=W)}function la(t,a,e,r,s,n,f,x,b){var h=a.length,y=e.items,j=e.first,l=j,m,o=null,d=[],c=[],k,M,u,E;for(E=0;E<h;E+=1){if(k=a[E],M=x(k,E),u=y.get(M),u===void 0){var p=r.get(M);if(p!==void 0){r.delete(M),y.set(M,p);var C=o?o.next:l;H(e,o,p),H(e,p,C),re(p,C,s),o=p}else{var I=l?l.e.nodes_start:s;o=ie(I,e,o,o===null?e.first:o.next,k,M,E,n,f,b)}y.set(M,o),d=[],c=[],l=o.next;continue}if(xe(u,k,E),(u.e.f&ae)!==0&&he(u.e),u!==l){if(m!==void 0&&m.has(u)){if(d.length<c.length){var R=c[0],N;o=R.prev;var L=d[0],q=d[d.length-1];for(N=0;N<d.length;N+=1)re(d[N],R,s);for(N=0;N<c.length;N+=1)m.delete(c[N]);H(e,L.prev,q.next),H(e,o,L),H(e,q,R),l=R,o=q,E-=1,d=[],c=[]}else m.delete(u),re(u,l,s),H(e,u.prev,u.next),H(e,u,o===null?e.first:o.next),H(e,o,u),o=u;continue}for(d=[],c=[];l!==null&&l.k!==M;)(l.e.f&ae)===0&&(m??=new Set).add(l),c.push(l),l=l.next;if(l===null)continue;u=l}d.push(u),o=u,l=u.next}if(l!==null||m!==void 0){for(var O=m===void 0?[]:pe(m);l!==null;)(l.e.f&ae)===0&&O.push(l),l=l.next;var V=O.length;if(V>0){var J=h===0?s:null;na(e,O,J)}}t.first=e.first&&e.first.e,t.last=o&&o.e;for(var i of r.values())me(i.e);r.clear()}function xe(t,a,e,r){Ue(t.v,a),t.i=e}function ie(t,a,e,r,s,n,f,x,b,h,y){var j=(b&Le)!==0,l=(b&Oe)===0,m=j?l?Re(s,!1,!1):ue(s):s,o=(b&De)===0?f:ue(f),d={i:o,v:m,k:n,a:null,e:null,prev:e,next:r};try{if(t===null){var c=document.createDocumentFragment();c.append(t=ve())}return d.e=se(()=>x(t,m,o,h),D),d.e.prev=e&&e.e,d.e.next=r&&r.e,e===null?y||(a.first=d):(e.next=d,e.e.next=d.e),r!==null&&(r.prev=d,r.e.prev=d.e),d}finally{}}function re(t,a,e){for(var r=t.next?t.next.e.nodes_start:e,s=a?a.e.nodes_start:e,n=t.e.nodes_start;n!==null&&n!==r;){var f=ze(n);s.before(n),n=f}}function H(t,a,e){a===null?t.first=e:(a.next=e,a.e.next=e&&e.e),e!==null&&(e.prev=a,e.e.prev=a&&a.e)}function oa(t,a,e=a){Ye(t,"change",()=>{e(t.files)}),D&&t.files&&e(t.files),Be(()=>{t.files=a()})}var fa=P('<div class="fixed inset-0 bg-[#7777] backdrop-filter-[blur(4px)] pt-20 z-999"><div class="p-2 m-auto w-90 rounded-sm shadow-md bg-[#fff]"><div class="flex justify-end"><button class="text-lg !bg-[transparent] !text-[#333] !p-1">&times;</button></div> <p class="text-center text-[1.2rem]"><!></p></div></div>');function da(t,a){var e=fa(),r=g(e),s=g(r),n=g(s);n.__click=function(...b){a.onClose?.apply(this,b)},_(s);var f=S(s,2),x=g(f);aa(x,()=>a.children??Ve),_(f),_(r),_(e),z(t,e)}_e(["click"]);var ca=P('<div class="fixed top-0 left-0 right-0 z-999"><div class="p-2 bg-[#333] shadow-md m-1 rounded-md"><p class="text-[#fff]"> </p></div></div>');function ua(t,a){var e=ca(),r=g(e),s=g(r),n=g(s,!0);_(s),_(r),_(e),ne(()=>B(n,a.text)),z(t,e)}var va=P('<div><form><div><p class="text-center">Upload your exported WhatsApp chats.</p></div> <div class="p-3 flex flex-column justify-center items-center"><label for="chat">Upload &uarr; <input type="file" name="chat" id="chat" class="!hidden"/></label></div></form></div>'),pa=(t,a,e)=>{T(a)==="ascending"?(v(a,"descending"),e.sort((r,s)=>s.count-r.count)):(v(a,"ascending"),e.sort((r,s)=>r.count-s.count))},ha=P('<p class="flex p-1 w-[80dvw] rounded-sm even:bg-[#ccc7]"><span class="svelte-2j7mc4"> </span> <span class="svelte-2j7mc4"> </span></p>'),ma=P('<div class="max-h-[65dvh] overflow-auto"><div class="sticky top-0 left-0 right-0 bg-[#fff] shadow-sm"><h3 class="text-center text-xl font-bold">Emojis found in chat:</h3> <p class="flex justify-end"><button class="!bg-[transparent] !text-[var(--button-primary)] text-md">Change order</button></p></div> <p class="flex p-1 w-[80dvw] rounded-sm even:bg-[#ccc7]"><span class="svelte-2j7mc4">Emoji</span> <span class="svelte-2j7mc4">Usage</span></p> <div class="flex justify-center flex-col items-center"></div></div> <div class="mt-4 p-2 flex flex-col justify-around items-center h-[8rem]"><button>Share stats</button> <button>Upload another chat</button></div>',1),_a=P('<section><!> <div class="p-2 grid place-items-center h-[100%]"><!> <!></div> <!> <!></section>');function Aa(t,a){Je(a,!0);const e=Intl.NumberFormat("en-US",{style:"decimal",useGrouping:!0});let r=[],s=F(te([])),n=te([]),f=F(te([])),x=F(void 0),b=F(void 0),h=F(""),y=F("descending"),j=F(!0),l=F(!1),m=F(""),o=F("Loading Unicode Emoji list. Please wait");Te(()=>{const i=new XMLHttpRequest;i.open("GET",`${ra}/array.json`),i.onload=function(){i.status===200?v(s,JSON.parse(i.responseText).emojis,!0):(v(j,!0),v(o,"An error occured. Failed to load Unicode Emoji List"))},i.onloadend=function(){v(j,!1)},i.send()});function d(){setTimeout(()=>{v(l,!1)},3e3)}function c(i){v(b,i.target.files[0],!0);const w=new FileReader;v(o,"Parsing chat..."),v(j,!0),w.onload=async function(A){v(h,await A.target.result,!0),v(j,!1);const $=T(h).replace(/\d/g,"").split("").filter(U=>U!==" ");T(s).forEach(U=>{const X=$.filter(G=>G===U);r.push(...X)}),k()},w.readAsText(T(b))}function k(){n.length=0,v(f,[...new Set(r)],!0),T(f).forEach(async i=>{n.push({emoji:i,count:r.filter(w=>i===w).length})}),n.sort((i,w)=>w.count-i.count),n.length===0&&(v(l,!0),v(m,"I could not find emojis in here, ensure you uploaded a TXT file of an exported WhatsApp chat. If you are sure you did, you lot don't use emojis when chatting eh?"),d(),M())}function M(){r.length=0,n.length=0,v(h,""),v(y,"descending"),v(x,void 0),v(b,void 0)}function u(){let i="";const w=n.slice(0,5);w.forEach(A=>i+=`
${A.emoji} -> ${A.count}`);try{navigator.share({text:`Top 5 emojis in WhatsApp chat with ${T(b).name}: ${w.forEach(A=>`${A.emoji} ${A.count}`)}`,url:location.toString()})}catch{v(j,!0),v(o,"An error occured while trying to share")}}var E=_a(),p=g(E);ta(p,{label:"TextMoji"});var C=S(p,2),I=g(C);{var R=i=>{var w=va(),A=g(w),$=S(g(A),2),U=g($),X=S(g(U));X.__change=c,_(U),_($),_(A),_(w),oa(X,()=>T(x),G=>v(x,G)),z(i,w)};Y(I,i=>{T(h)===""&&i(R)})}var N=S(I,2);{var L=i=>{var w=ma(),A=Qe(w),$=g(A),U=S(g($),2),X=g(U);X.__click=[pa,y,n],_(U),_($);var G=S($,4);ia(G,21,()=>n,sa,(be,fe)=>{var K=ha(),Q=g(K),Ee=g(Q,!0);_(Q);var de=S(Q,2),we=g(de,!0);_(de),_(K),ne(ye=>{B(Ee,T(fe).emoji),B(we,ye)},[()=>e.format(T(fe).count)]),z(be,K)}),_(G),_(A);var le=S(A,2),oe=g(le);oe.__click=u;var ge=S(oe,2);ge.__click=M,_(le),z(i,w)};Y(N,i=>{n.length!==0&&i(L)})}_(C);var q=S(C,2);{var O=i=>{da(i,{onClose:()=>v(j,!1),children:(w,A)=>{Ze();var $=ea();ne(()=>B($,T(o))),z(w,$)}})};Y(q,i=>{T(j)&&i(O)})}var V=S(q,2);{var J=i=>{ua(i,{get text(){return T(m)}})};Y(V,i=>{T(l)&&i(J)})}_(E),z(t,E),Ke()}_e(["change","click"]);export{Aa as component};
